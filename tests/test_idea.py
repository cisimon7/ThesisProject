import numpy as np
from unittest import TestCase

from Constrained.FullSystem import FullSystem


class TestIdea(TestCase):

    def test_sys(self):
        sys = FullSystem(
            A=np.array([
                [0.29388389, 0.60619791, 0.61711047, 0.98134008, 0.8411186],
                [0.17693043, 0.03707734, 0.4704481, 0.37946392, 0.26073155],
                [0.17234994, 0.00099042, 0.09406578, 0.13462686, 0.59497191],
                [0.02387212, 0.71286746, 0.70349125, 0.5670503, 0.37909315],
                [0.49230875, 0.14454622, 0.78801647, 0.03618107, 0.91140465]
            ]),
            B=np.array([
                [0.57687472, 0.98192325, 0.49108052],
                [0.89164231, 0.82203857, 0.62980234],
                [0.29258367, 0.86144339, 0.61083259],
                [0.26803695, 0.28221136, 0.21249502],
                [0.82645489, 0.0847191, 0.27868093]
            ]),
            G=np.array([
                [5.33, 2.692, 4.241, 4.564, 1.835],
                [2.619, 2.781, 4.491, 6.801, 3.085],
                [31.98, 16.152, 25.446, 27.384, 11.01],
                [37.034, 27.454, 43.91, 59.062, 25.85]
            ]),
            F=np.array([
                [0.90561087, 0.46770737, 0.49420815, 0.1559242, 0.09016879, 0.58504117],
                [0.75716534, 0.873799, 0.11249054, 0.46628263, 0.13524094, 0.89432745],
                [0.18143612, 0.16911702, 0.88149943, 0.42200387, 0.88007125, 0.24401606],
                [0.88693047, 0.01659639, 0.46908306, 0.19753509, 0.02025264, 0.07489282],
                [0.88566959, 0.07450498, 0.81403114, 0.34240506, 0.70330564, 0.05149097]
            ]),
            init_state=np.array([0.5473899, 0.94628836, 0.45888643, 0.86570615, 0.27199946])
        )
        sys.ode_solve()
        sys.pplot_states()
